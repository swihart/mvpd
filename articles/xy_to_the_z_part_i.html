<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>(XY)^Z Part I • mvpd</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="(XY)^Z Part I">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mvpd</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/deep_dive_kolm.html">Deeper Dive: Kolmogorov Distribution, Density, Random Variates</a></li>
    <li><a class="dropdown-item" href="../articles/intro.html">Introduction and Primer</a></li>
    <li><a class="dropdown-item" href="../articles/intro1.html">Introduction and Primer II</a></li>
    <li><a class="dropdown-item" href="../articles/mvt_mvss_mvcauchy.html">Why do both the mvt and mvss have a mvcauchy special instance?</a></li>
    <li><a class="dropdown-item" href="../articles/xy_to_the_z_part_i.html">(XY)^Z Part I</a></li>
    <li><a class="dropdown-item" href="../articles/xy_to_the_z_part_ii.html">(XY)^Z Part II</a></li>
    <li><a class="dropdown-item" href="../articles/xy_to_the_z_part_iii.html">(XY)^Z Part III</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/swihart/mvpd/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>(XY)^Z Part I</h1>
                        <h4 data-toc-skip class="author">Bruce J.
Swihart</h4>
            
            <h4 data-toc-skip class="date">2025-05-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/swihart/mvpd/blob/main/vignettes/articles/xy_to_the_z_part_i.Rmd" class="external-link"><code>vignettes/articles/xy_to_the_z_part_i.Rmd</code></a></small>
      <div class="d-none name"><code>xy_to_the_z_part_i.Rmd</code></div>
    </div>

    
    
<hr>
<p><strong>IN PROGRESS</strong></p>
<hr>
<p>I’m about 8 months late to the party, but a challenge problem from
3blue1brown caught my attention, as well as a call for intuitive
approaches to explaining the result.</p>
<blockquote>
<p>Here’s the challenge mode for all you math whizzes. Sample three
numbers x, y, z uniformly at random in [0, 1], and compute (xy)^z. What
distribution describes this result?</p>
<p>Answer: It’s uniform!</p>
<p>I know how to prove it, but haven’t yet found the “aha” style
explanation where it feels expected or visualizable. If any of you have
one, please send it my way and I’ll strongly consider making a video on
it.</p>
<p>– Grant Sanderson of 3blue1brown, 2024-09-10</p>
</blockquote>
<p>While this relation and proofs of the result have been around for a
while, as shown in this <a href="https://math.stackexchange.com/q/261783/180716" class="external-link">Math SE post from
2012</a>, the renewed notoriety is how it caught my attention – and even
then 8 months after the fact. I agree none of the suggested proofs have
a slam-dunk visualization.</p>
<p>This <a href="https://www.youtube.com/watch?v=qNXBwiAsvZM&amp;t=277s" class="external-link">response
video by Dr Mihai Nica</a> includes an explanation has some similarities
to the approaches on this page and connects it to Poisson processes and
some other statistical results. I focus more on visualizing the
distributions and thinking of the result in terms of convolution and
scale mixture, which should be no surprise given these concepts are
commonly used in the underlying theory of <code>mvpd</code>. I also
generalize the result, showing that the original problem is a specific
instance of this more general result.</p>
<div class="section level2">
<h2 id="restatement-of-the-relations">Restatement of the Relations<a class="anchor" aria-label="anchor" href="#restatement-of-the-relations"></a>
</h2>
<div class="section level3">
<h3 id="overview-sketch">Overview Sketch<a class="anchor" aria-label="anchor" href="#overview-sketch"></a>
</h3>
<p>The original problem could be stated as:</p>
<p>If</p>
<ul>
<li>X ~ U(0,1)</li>
<li>Y ~ U(0,1)</li>
<li>Z ~ U(0,1)</li>
</ul>
<p>Then</p>
<ul>
<li>(XY)^Z ~ U(0,1)</li>
</ul>
<p>We first note that
Beta(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
1) is a generalization of the U(0,1). For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\alpha=1</annotation></semantics></math>,
Beta(1,1) is the same as U(0,1). I had a hunch the result would
generalize, so for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\alpha &gt; 0</annotation></semantics></math>,
we state:</p>
<p>If</p>
<ul>
<li>X ~
Beta(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
1)</li>
<li>Y ~
Beta(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
1)</li>
<li>Z ~ U(0,1),</li>
</ul>
<p>Then</p>
<ul>
<li>(XY)^Z ~
Beta(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
1)</li>
</ul>
<p>We then can generalize the distribution of Z to Beta(1, K-1), where K
is the number of random variates being multiplied. In the original
problem, K=2, because X and Y were being multiplied and raised to Z.
Well, for K=2, Beta(1,K-1) is Beta(1,1) which is U(0,1). That leaves us
with:</p>
<p>If</p>
<ul>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>1</mn></msub><annotation encoding="application/x-tex">X_1</annotation></semantics></math>
~
Beta(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
1)</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>2</mn></msub><annotation encoding="application/x-tex">X_2</annotation></semantics></math>
~
Beta(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
1)</p></li>
<li><p>…</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>K</mi></msub><annotation encoding="application/x-tex">X_K</annotation></semantics></math>
~
Beta(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
1)</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math>
~ Beta(1, K-1)</p></li>
</ul>
<p>Then</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mn>1</mn></msub><msub><mi>X</mi><mn>2</mn></msub><mi>…</mi><msub><mi>X</mi><mi>K</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>Z</mi></msup><annotation encoding="application/x-tex">\left(X_1 X_2 \dots X_K \right)^Z</annotation></semantics></math>
~
Beta(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
1)</li>
</ul>
<p>Turns out there is another computed quantity with a distribution:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>1</mn><mrow><msub><mi>X</mi><mn>1</mn></msub><msub><mi>X</mi><mn>2</mn></msub><mi>…</mi><msub><mi>X</mi><mi>K</mi></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>Z</mi></msup><annotation encoding="application/x-tex">\left( \frac{1}{X_1 X_2 \dots X_K} \right)^Z</annotation></semantics></math>
~ Pareto(scale = 1,
shape=<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>)</li>
</ul>
<p>We will make pictures of these computed quantities to show they
follow these distributions in a bit. While they are useful, they are
more confirmatory than intuition building.</p>
<p>For building intuition, I view things on the
<strong>log-scale</strong>, which changes the computed quantities from
<strong>a product raised to a power</strong> to <strong>a sum multiplied
by a scalar</strong>. Since these are random variables, this amounts to
a convolution and then a change of scale (aka “scale mixtures”). As one
can see, this challenge problem is right up <code>mvpd</code>’s
alley!</p>
<p>Going forward, it may be useful to know that</p>
<p>If</p>
<ul>
<li>X ~
Beta(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
1)</li>
</ul>
<p>Then</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log(X)</annotation></semantics></math>
~
ReflectedExp(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sum_{k=1}^K  \log(X_k)</annotation></semantics></math>
~ ReflectedGamma(K,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>)</li>
</ul>
<p>and</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>1</mn><mi>X</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log(\frac{1}{X})</annotation></semantics></math>
=
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">-\log(X)</annotation></semantics></math>
~
Exp(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup><mo>−</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sum_{k=1}^K -\log(X_k)</annotation></semantics></math>
~ Gamma(K,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>)</li>
</ul>
<p>As well as</p>
<ul>
<li>If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mn>1</mn></msub><mo>,</mo><msub><mi>u</mi><mn>2</mn></msub><mo>,</mo><msub><mi>u</mi><mn>3</mn></msub><mo>,</mo><mi>…</mi><msub><mi>u</mi><mi>K</mi></msub></mrow><annotation encoding="application/x-tex">u_1, u_2, u_3, \dots u_K</annotation></semantics></math>
iid U(0,1) then
min(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mn>1</mn></msub><mo>,</mo><msub><mi>u</mi><mn>2</mn></msub><mo>,</mo><msub><mi>u</mi><mn>3</mn></msub><mo>,</mo><mi>…</mi><msub><mi>u</mi><mi>K</mi></msub></mrow><annotation encoding="application/x-tex">u_1, u_2, u_3, \dots u_K</annotation></semantics></math>)
~ Beta(1,K-1).</li>
</ul>
<p>We’ll make lots of pictures of these down below. Quickly, I’ll state
what we are showing with those pictures.</p>
<blockquote>
<p>In short, for intuition, the sum of a bunch of exponentials is a
gamma, and to recover the original exponential distribution, the sum is
multiplied by a beta.</p>
</blockquote>
<p>Well, that’s the way you’d say it at coffee before a seminar to seem
cool. The parts that fill it in a bit more:</p>
<blockquote>
<p>In short, for intuition, the sum of K iid exponential random
variables with common rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
is a
gamma(K,<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>).
To recover the original exponential distribution, the sum is multiplied
by a beta(1, K-1) random variable.</p>
</blockquote>
<p>For those that would like a density argument:</p>
<ul>
<li><p>The sum
S~Gamma(K,<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>)
has density
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><msup><mi>α</mi><mi>K</mi></msup><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>K</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><msup><mi>x</mi><mrow><mi>K</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>α</mi><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(x) = \frac{\alpha^K}{\Gamma(K)} x^{K-1} \exp(-\alpha x)</annotation></semantics></math></p></li>
<li><p>The product ZS ~ Gamma(K,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>/Z)
has density
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mi>/</mi><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>K</mi></msup><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>K</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><msup><mi>x</mi><mrow><mi>K</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mi>/</mi><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(x) = \frac{(\alpha/Z)^K}{\Gamma(K)} x^{K-1} \exp(-(\alpha/Z) x)</annotation></semantics></math></p></li>
<li><p>Since Z is random we want to integrate it out with respect to its
distribution. So the puzzle becomes for what
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mi>z</mi></msub><annotation encoding="application/x-tex">f_z</annotation></semantics></math>
does the integral solve to the exponential density
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>α</mi><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>α</mi><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(x) = \alpha \exp(-\alpha x)</annotation></semantics></math>?</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∫</mo><msub><mi>f</mi><mi>x</mi></msub><msub><mi>f</mi><mi>z</mi></msub><mi>d</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">\int f_x f_z dz</annotation></semantics></math>
=
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∫</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mi>/</mi><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>K</mi></msup><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>K</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><msup><mi>x</mi><mrow><mi>K</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mi>/</mi><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>f</mi><mi>z</mi></msub><mi>d</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">\int f(x) = \frac{(\alpha/Z)^K}{\Gamma(K)} x^{K-1} \exp(-(\alpha/Z) x) f_z dz</annotation></semantics></math></p></li>
<li>
<p>If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>z</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>K</mi><mo>−</mo><mn>2</mn></mrow></msup><mrow><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mi>K</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">f_z(z) = \frac{(1-z)^{K-2}}{B(1,K-1)}</annotation></semantics></math>,
then</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∫</mo><msub><mi>f</mi><mi>x</mi></msub><msub><mi>f</mi><mi>z</mi></msub><mi>d</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">\int f_x f_z dz</annotation></semantics></math>
=
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∫</mo><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mi>/</mi><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>K</mi></msup><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>K</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><msup><mi>x</mi><mrow><mi>K</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mi>/</mi><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>K</mi><mo>−</mo><mn>2</mn></mrow></msup><mi>d</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">\int \frac{(\alpha/Z)^K}{\Gamma(K-1)\Gamma(1)} x^{K-1} \exp(-(\alpha/Z) x) (1-z)^{K-2} dz</annotation></semantics></math>
=</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><msup><mi>x</mi><mrow><mi>K</mi><mo>−</mo><mn>1</mn></mrow></msup><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>K</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>∫</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mi>/</mi><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>K</mi></msup><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mi>/</mi><mi>Z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>K</mi><mo>−</mo><mn>2</mn></mrow></msup><mi>d</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">\frac{x^{K-1}}{\Gamma(K-1)}  \int (\alpha/Z)^K \exp(-(\alpha/Z) x) (1-z)^{K-2} dz</annotation></semantics></math>
=</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><msup><mi>x</mi><mrow><mi>K</mi><mo>−</mo><mn>1</mn></mrow></msup><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>K</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>α</mi><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mfrac><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>K</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msup><mi>x</mi><mrow><mi>K</mi><mo>+</mo><mn>1</mn></mrow></msup></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{x^{K-1}}{\Gamma(K-1)} \left( \alpha \exp(-\alpha x) \frac{\Gamma(K-1)}{x^{K+1}}  \right)</annotation></semantics></math>
=</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>α</mi><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mi>◼</mi></mrow><annotation encoding="application/x-tex">\alpha \exp(-\alpha x) ~~\blacksquare</annotation></semantics></math></li>
</ul>
</li>
</ul>
<p>In closing, we generalize X, Y being iid
Beta(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
1) (which for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\alpha=1</annotation></semantics></math>
is U(0,1)) and restate the result for the computed quantity
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mi>Y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>Z</mi></msup><annotation encoding="application/x-tex">(XY)^Z</annotation></semantics></math>.
We then consider a similar, computed quantity
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>1</mn><mrow><mi>X</mi><mi>Y</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>Z</mi></msup><annotation encoding="application/x-tex">\left(\frac{1}{XY} \right)^Z</annotation></semantics></math>
as well. For each quantity we build intuition by thinking through the
distributions on the log-scale.</p>
</div>
</div>
<div class="section level2">
<h2 id="concise-statements">Concise statements<a class="anchor" aria-label="anchor" href="#concise-statements"></a>
</h2>
<hr>
<p>Result 1 and 2 generalizes the U(0,1) of the X, Y, and (XY)^Z to
Beta(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
1).</p>
<p>For iid
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>,</mo><mi>Y</mi><mo>∼</mo></mrow><annotation encoding="application/x-tex">X,Y \sim</annotation></semantics></math>
Beta(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
1) and independent
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>∼</mo><mi>U</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Z \sim U(0,1)</annotation></semantics></math></p>
<p><strong>Result 1</strong>:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mi>Y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>Z</mi></msup><mo>∼</mo></mrow><annotation encoding="application/x-tex">(XY)^Z  \sim</annotation></semantics></math>
Beta(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
1)
<ul>
<li>Which implies
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><mi>X</mi><mo>+</mo><mo>log</mo><mi>Y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo></mrow><annotation encoding="application/x-tex">Z \left( \log X + \log Y \right) \sim</annotation></semantics></math>
ReflectedExp(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>)</li>
</ul>
</li>
</ul>
<p><strong>Result 2</strong>:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>1</mn><mrow><mi>X</mi><mi>Y</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>Z</mi></msup><mo>∼</mo></mrow><annotation encoding="application/x-tex">\left(\frac{1}{XY} \right)^Z  \sim</annotation></semantics></math>
Pareto(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>m</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x_m=1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mi>m</mi></msub><mo>=</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha_m = \alpha</annotation></semantics></math>)
<ul>
<li>Which implies
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><mfrac><mn>1</mn><mi>X</mi></mfrac><mo>+</mo><mo>log</mo><mfrac><mn>1</mn><mi>Y</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo></mrow><annotation encoding="application/x-tex">Z \left( \log \frac{1}{X} + \log \frac{1}{Y} \right) \sim</annotation></semantics></math>
Exp(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>)</li>
</ul>
</li>
</ul>
<p>The original challenge problem is the special
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\alpha = 1</annotation></semantics></math>
instance:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>,</mo><mi>Y</mi><mo>,</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">X,Y,Z</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mi>Y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>Z</mi></msup><mo>∼</mo></mrow><annotation encoding="application/x-tex">(XY)^Z  \sim</annotation></semantics></math>
U(0,1) (because Beta(1, 1) is U(0,1)).</p>
<p>Result 1-K and 2-K generalizes the U(0,1) of the Z to Beta(1,
K-1).</p>
<p>For iid
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>k</mi></msub><mo>∼</mo></mrow><annotation encoding="application/x-tex">X_k \sim</annotation></semantics></math>
Beta(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
1),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>K</mi><mo>,</mo><mi>K</mi><mo>∈</mo><mrow><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi></mrow></mrow><annotation encoding="application/x-tex">k=1,...,K, K \in {1,2,...}</annotation></semantics></math>
and independent
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>∼</mo><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mi>K</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Z \sim Beta(1,K-1)</annotation></semantics></math></p>
<p><strong>Result 1-K</strong>:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mo>∏</mo><msub><mi>X</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>Z</mi></msup><mo>∼</mo></mrow><annotation encoding="application/x-tex">(\prod X_k)^Z  \sim</annotation></semantics></math>
Beta(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
1)
<ul>
<li>Which implies
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>∑</mo><mo>log</mo><msub><mi>X</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo></mrow><annotation encoding="application/x-tex">Z \left( \sum \log X_k \right) \sim</annotation></semantics></math>
ReflectedExp(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>)</li>
</ul>
</li>
</ul>
<p><strong>Result 2-K</strong>:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mo>∏</mo><mfrac><mn>1</mn><msub><mi>X</mi><mi>k</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>Z</mi></msup><mo>∼</mo></mrow><annotation encoding="application/x-tex">\left( \prod \frac{1}{X_k} \right)^Z  \sim</annotation></semantics></math>
Pareto(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>m</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x_m=1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mi>m</mi></msub><mo>=</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha_m = \alpha</annotation></semantics></math>)
<ul>
<li>Which implies
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>∑</mo><mo>log</mo><mfrac><mn>1</mn><msub><mi>X</mi><mi>k</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo></mrow><annotation encoding="application/x-tex">Z \left( \sum \log \frac{1}{X_k} \right) \sim</annotation></semantics></math>
Exp(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>)</li>
</ul>
</li>
</ul>
<p>The original challenge problem is the special
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\alpha = 1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">K=2</annotation></semantics></math>
instance:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>,</mo><mi>Y</mi><mo>,</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">X,Y,Z</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mi>Y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>Z</mi></msup><mo>∼</mo></mrow><annotation encoding="application/x-tex">(XY)^Z  \sim</annotation></semantics></math>
U(0,1) (because Beta(1, 1) is U(0,1)).</p>
<p>Also note this holds for K=1 because Beta(1,0) is the point mass
(constant) 1 (in limit).</p>
<div class="section level3">
<h3 id="sanity-check-result-1">Sanity check: Result 1<a class="anchor" aria-label="anchor" href="#sanity-check-result-1"></a>
</h3>
<p>Lets do a number of simulations and then plot the quantities to see
the theory in action for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mi>Y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>Z</mi></msup><mo>∼</mo></mrow><annotation encoding="application/x-tex">(XY)^Z  \sim</annotation></semantics></math>
Beta(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
1). That is, we will draw 10,000 random variates of each X, Y, and Z,
plot density histograms of those draws and of combinations of those
draws. (Quick note: One can increase this number in the .Rmd file linked
below the title by changing the global variable
<code>nsim.switch</code>. I kept it moderate for web building/loading
purposes; cranking it up allows the barplots to more accurately “fall in
line” with the overlaid density.)</p>
<p>We will also overlay the theoretical result – that is, the density
that the mathematical/statistical theory says the quantity should take –
in purple on top of the histogram. First for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\alpha=1</annotation></semantics></math>,
the special uniform instance (because that is what started it all!) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>4.318</mn></mrow><annotation encoding="application/x-tex">\alpha=4.318</annotation></semantics></math>
as an arbitrary value bigger than 1 and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>0.633</mn></mrow><annotation encoding="application/x-tex">\alpha=0.633</annotation></semantics></math>
as an arbitrary value smaller than 1.</p>
<div class="section level4">
<h4 id="alpha-1">alpha = 1<a class="anchor" aria-label="anchor" href="#alpha-1"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">nsims</span> <span class="op">&lt;-</span> <span class="va">nsim.switch</span></span>
<span><span class="va">aa_x</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">aa_y</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="va">nsims</span>,<span class="va">aa_x</span>,<span class="fl">1</span><span class="op">)</span> <span class="co">##runif(nsims,0,1)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="va">nsims</span>,<span class="va">aa_y</span>,<span class="fl">1</span><span class="op">)</span> <span class="co">##runif(nsims,0,1)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">nsims</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span><span class="op">*</span><span class="va">y</span><span class="op">)</span><span class="op">^</span><span class="va">z</span>, breaks<span class="op">=</span><span class="fl">50</span>, freq<span class="op">=</span><span class="cn">FALSE</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>               <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.01</span><span class="op">)</span>,</span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.01</span><span class="op">)</span>,<span class="va">aa_x</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>                     type<span class="op">=</span><span class="st">"l"</span>,</span>
<span>                     lwd<span class="op">=</span><span class="va">overlaid.dens.lwd</span>,</span>
<span>                     col<span class="op">=</span><span class="st">"purple"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">x</span>, freq<span class="op">=</span><span class="cn">FALSE</span>, breaks<span class="op">=</span><span class="fl">50</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>               <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.01</span><span class="op">)</span>,</span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.01</span><span class="op">)</span>,<span class="va">aa_x</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>                     type<span class="op">=</span><span class="st">"l"</span>,</span>
<span>                     lwd<span class="op">=</span><span class="va">overlaid.dens.lwd</span>,</span>
<span>                     col<span class="op">=</span><span class="st">"purple"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## compare mean, variance, and 2nd moment</span></span>
<span><span class="va">prod</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x</span><span class="op">*</span><span class="va">y</span><span class="op">)</span><span class="op">^</span><span class="va">z</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">prod</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.5000949</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">prod</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.08372655</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">prod</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">prod</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="co">#&gt; [1] 0.3338215</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.501578</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.0843729</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="co">#&gt; [1] 0.3359534</span></span></code></pre></div>
<p><img src="xy_to_the_z_part_i_files/figure-html/unnamed-chunk-2-1.png" width="50%"><img src="xy_to_the_z_part_i_files/figure-html/unnamed-chunk-2-2.png" width="50%"></p>
</div>
<div class="section level4">
<h4 id="alpha-4-318">alpha = 4.318<a class="anchor" aria-label="anchor" href="#alpha-4-318"></a>
</h4>
<p><img src="xy_to_the_z_part_i_files/figure-html/unnamed-chunk-3-1.png" width="50%"><img src="xy_to_the_z_part_i_files/figure-html/unnamed-chunk-3-2.png" width="50%"></p>
</div>
<div class="section level4">
<h4 id="alpha-0-633">alpha = 0.633<a class="anchor" aria-label="anchor" href="#alpha-0-633"></a>
</h4>
<p><img src="xy_to_the_z_part_i_files/figure-html/unnamed-chunk-4-1.png" width="50%"><img src="xy_to_the_z_part_i_files/figure-html/unnamed-chunk-4-2.png" width="50%"></p>
</div>
</div>
<div class="section level3">
<h3 id="log-scale-for-intuition-building">Log-scale for intuition building<a class="anchor" aria-label="anchor" href="#log-scale-for-intuition-building"></a>
</h3>
<p>Consider the log scale, which changes the relation from a product
raised to a power into a sum multiplied by a number. In other words, a
convolution (sum of two random variables) and a scale mixture (then
multiplied by a random variable).</p>
<p>We will visualize this using 5 plots arranged in a 3x3 grid. The left
column will show the distributions of each of the 3 components of
consideration (log(X), log(Y), and Z), the middle column will just show
the convolution of log(X) and log(Y), that is to say log(X)+log(Y), and
the third one will show the scale mixture applied to the convolution. If
a line appears on top of the histogram, that’s the theoretical result,
and the bars falling nicely along the line shows agreement between the
simulation and the expected theoretical result.</p>
<p>Take a look at this for alpha=1:</p>
<p><img src="xy_to_the_z_part_i_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>Quick observations –</p>
<ul>
<li>log(X): is a Reflected Exponential with rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
as is log(Y) <em>and</em> Z(log(X)+log(Y))!
<ul>
<li>the bars fall along the red density line</li>
</ul>
</li>
<li>log(X) + log(Y): the convolution (i.e., sum) of two Reflected
Exponentials is more disperse and squattier than just one Reflected
Exponential. We know this already – think of adding two normals together
and the variance of the resultant Normal having the sum of the variances
of the original normals.
<ul>
<li>the bars fall along a
RefelectedGamma(2,<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>)
density</li>
</ul>
</li>
<li>Z(log(X)+log(Y)): to “recover” or “get back to” the original
distribution before the convolution, log(X), we need to “tighten” or
“gather” or “concentrate” the log(X)+log(Y) distribution. Multiplying it
by a random number between 0 and 1 will do exactly that.</li>
</ul>
<p>See for other values for alpha:</p>
<div class="section level4">
<h4 id="alpha-4-318-1">alpha = 4.318<a class="anchor" aria-label="anchor" href="#alpha-4-318-1"></a>
</h4>
<p><img src="xy_to_the_z_part_i_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="alpha-0-633-1">alpha = 0.633<a class="anchor" aria-label="anchor" href="#alpha-0-633-1"></a>
</h4>
<p><img src="xy_to_the_z_part_i_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="sanity-check-result-2">Sanity check: Result 2<a class="anchor" aria-label="anchor" href="#sanity-check-result-2"></a>
</h3>
<p>Now we draw a bunch of random beta and uniform random variables and
then plot the quantities to see the theory in action for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>1</mn><mrow><mi>X</mi><mi>Y</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>Z</mi></msup><mo>∼</mo></mrow><annotation encoding="application/x-tex">\left(\frac{1}{XY} \right)^Z  \sim</annotation></semantics></math>
Pareto(scale<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">=1</annotation></semantics></math>,
shape<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">= \alpha</annotation></semantics></math>).
We will plot the theoretical result in purple on top of the histogram.
First for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\alpha=1</annotation></semantics></math>,
the special uniform instance (because that is what started it all for
Result 1!) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>4.318</mn></mrow><annotation encoding="application/x-tex">\alpha=4.318</annotation></semantics></math>
as an arbitrary value bigger than 1 and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>0.633</mn></mrow><annotation encoding="application/x-tex">\alpha=0.633</annotation></semantics></math>
as an arbitrary value smaller than 1.</p>
<div class="section level4">
<h4 id="alpha-1-000">alpha = 1.000<a class="anchor" aria-label="anchor" href="#alpha-1-000"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">nsims</span> <span class="op">&lt;-</span> <span class="va">nsim.switch</span></span>
<span><span class="va">aa_x</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">aa_y</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="va">nsims</span>,<span class="va">aa_x</span>,<span class="fl">1</span><span class="op">)</span> <span class="co">##runif(nsims,0,1)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="va">nsims</span>,<span class="va">aa_y</span>,<span class="fl">1</span><span class="op">)</span> <span class="co">##runif(nsims,0,1)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">nsims</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">x</span><span class="op">*</span><span class="fl">1</span><span class="op">/</span><span class="va">y</span><span class="op">)</span><span class="op">^</span><span class="va">z</span>, breaks<span class="op">=</span><span class="va">nsim.switch</span>, freq<span class="op">=</span><span class="cn">FALSE</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">15</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>               <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">0.01</span><span class="op">)</span>,</span>
<span>                     <span class="fu">LNPar</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/LNPar/man/dpareto.html" class="external-link">dpareto</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">0.01</span><span class="op">)</span>,<span class="fl">1</span>,alpha<span class="op">=</span><span class="va">aa_x</span><span class="op">)</span>,</span>
<span>                     type<span class="op">=</span><span class="st">"l"</span>,</span>
<span>                     lwd<span class="op">=</span><span class="va">overlaid.dens.lwd</span>,</span>
<span>                     col<span class="op">=</span><span class="st">"purple"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">x</span>, freq<span class="op">=</span><span class="cn">FALSE</span>, breaks<span class="op">=</span><span class="fl">6e4</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">15</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>               <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">0.01</span><span class="op">)</span>,</span>
<span>                     <span class="fu">LNPar</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/LNPar/man/dpareto.html" class="external-link">dpareto</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">0.01</span><span class="op">)</span>,<span class="fl">1</span>,alpha<span class="op">=</span><span class="va">aa_x</span><span class="op">)</span>,</span>
<span>                     type<span class="op">=</span><span class="st">"l"</span>,</span>
<span>                     lwd<span class="op">=</span><span class="va">overlaid.dens.lwd</span>,</span>
<span>                     col<span class="op">=</span><span class="st">"purple"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## compare mean, variance, and 2nd moment</span></span>
<span><span class="va">prod</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">x</span><span class="op">*</span><span class="fl">1</span><span class="op">/</span><span class="va">y</span><span class="op">)</span><span class="op">^</span><span class="va">z</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">prod</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 8.878238</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">prod</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4277.258</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">prod</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">prod</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="co">#&gt; [1] 4356.082</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 10.28434</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 32794.94</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">x</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="co">#&gt; [1] 32900.71</span></span></code></pre></div>
<p><img src="xy_to_the_z_part_i_files/figure-html/unnamed-chunk-8-1.png" width="50%"><img src="xy_to_the_z_part_i_files/figure-html/unnamed-chunk-8-2.png" width="50%"></p>
</div>
<div class="section level4">
<h4 id="alpha-4-318-2">alpha = 4.318<a class="anchor" aria-label="anchor" href="#alpha-4-318-2"></a>
</h4>
<p><img src="xy_to_the_z_part_i_files/figure-html/unnamed-chunk-9-1.png" width="50%"><img src="xy_to_the_z_part_i_files/figure-html/unnamed-chunk-9-2.png" width="50%"></p>
</div>
<div class="section level4">
<h4 id="alpha-0-633-2">alpha = 0.633<a class="anchor" aria-label="anchor" href="#alpha-0-633-2"></a>
</h4>
<p><img src="xy_to_the_z_part_i_files/figure-html/unnamed-chunk-10-1.png" width="50%"><img src="xy_to_the_z_part_i_files/figure-html/unnamed-chunk-10-2.png" width="50%"></p>
</div>
</div>
<div class="section level3">
<h3 id="log-scale-for-intuition-building-1">Log-scale for intuition building<a class="anchor" aria-label="anchor" href="#log-scale-for-intuition-building-1"></a>
</h3>
<p>Consider the log scale, which changes the relation from a product
raised to a power into a sum multiplied by a number. In other words, a
convolution (sum of two random variables) and a scale mixture (then
multiplied by a random variable).</p>
<p>We will visualize this using 5 plots arranged in a 3x3 grid. The left
column will show the distributions of each of the 3 components of
consideration (log(X), log(Y), and Z), the middle column will just show
the convolution of log(X) and log(Y), that is to say log(X)+log(Y), and
the third one will show the scale mixture applied to the
convolution.</p>
<p>Take a look at this for alpha=1:</p>
<p><img src="xy_to_the_z_part_i_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>Quick observations –</p>
<ul>
<li>log(X): is an
Exponential(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>),
as is log(Y) <em>and</em> Z(log(X)+log(Y))!</li>
<li>log(X) + log(Y): the convolution (i.e., sum) of two Exponentials is
more disperse and squattier. We know this already – think of adding two
normals together and the variance of the resultant Normal having the sum
of the variances of the original normals.
<ul>
<li>the bars fall along a
Gamma(2,<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>)
density<br>
</li>
</ul>
</li>
<li>Z(log(X)+log(Y)): to “recover” or “get back to” the original
distribution before the convolution, log(X), we need to “tighten” or
“gather” or “concentrate” the log(X)+log(Y) distribution. Multiplying it
by a random number between 0 and 1 will do exactly that.</li>
</ul>
<p>See for other values for alpha:</p>
<div class="section level4">
<h4 id="alpha-4-318-3">alpha = 4.318<a class="anchor" aria-label="anchor" href="#alpha-4-318-3"></a>
</h4>
<p><img src="xy_to_the_z_part_i_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="alpha-0-633-3">alpha = 0.633<a class="anchor" aria-label="anchor" href="#alpha-0-633-3"></a>
</h4>
<p><img src="xy_to_the_z_part_i_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="follow-up-questions">Follow-up questions<a class="anchor" aria-label="anchor" href="#follow-up-questions"></a>
</h3>
<p>Follow up questions means we can explore more. This was a top comment
on the response video linked in the intro:</p>
<blockquote>
<p><span class="citation">@JobBouwman</span> 8 months ago Adding two
exponentials will double the outcome. Then multiplying this with a
random uniform scalar between 0 and 1 will on average half the
result.</p>
</blockquote>
<p>This comment in addition to the video helped inspire this document.
The comment in particular inspired two questions of mine.</p>
<ul>
<li>Q: Why “1/2 on average” and not just “1/2 all the time with no
variation”?</li>
</ul>
<p>Let’s see what the resultant Z(log(1/X)+log(1/Y)) distribution would
look like if we replaced <code>z&lt;-runif(nsims, 0, 1)</code> with
<code>z &lt;- rep(1/2, nsims)</code> in the code. We will see it
“concentrates” too much and doesn’t recover the distribution of log(1/X)
– the bars go well above the red density line of the exponential:</p>
<p><img src="xy_to_the_z_part_i_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<ul>
<li>Q: Ok, so Z has to be random. But can it be 1/2 on average but with
bounds bigger than 0,1 ?</li>
</ul>
<p>Let’s see what the resultant Z(log(1/X)+log(1/Y)) distribution would
look like if we replaced <code>z&lt;-runif(nsims, 0, 1)</code> with
<code>z&lt;-runif(nsims, -1, 2)</code> in the code. The mean of Z is
1/2. However, Z is not bounded between 0 and 1. Hypothesis: even though
this Z will “1/2 on average” it fails to recover the distribution
log(1/X) because Z values bigger than 1 fail to “tighten” the
distribution. Compounding the problem is that Z values below 0 (negative
values) flip/reflect values across the y-axis. See below:</p>
<p><img src="xy_to_the_z_part_i_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="bonus-what-about-3-exponentials">Bonus: What about 3 exponentials?<a class="anchor" aria-label="anchor" href="#bonus-what-about-3-exponentials"></a>
</h2>
<p>We have already stated Results 1-K and 2-K which generalized things
to summing K exponentials. However, let’s build some intuition
pretending we did not have those results and just tried to add a 3rd
variable to the procedure we have been doing to this point.</p>
<p>Let’s see what the resultant Z(log(1/X)+log(1/Y)+log(1/A))
distribution would look like, with X,Y,A as iid beta(0.633,1) and an
independent Z iid U(0,1)</p>
<p><img src="xy_to_the_z_part_i_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>It looks like we need more tightening from Z. Let’s tinker. Instead
of multiplying by 1/2 on average, perhaps we need to multiply by 1/3 on
average? Let’s leave Z as a uniform, with positive values smaller than 1
that average to a 1/3. Let’s replace
<code>z&lt;-runif(nsims, 0, 1)</code> with
<code>z&lt;-runif(nsims, 0, 2/3)</code> in the code:</p>
<p><img src="xy_to_the_z_part_i_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p>While that was fun, this modification (shortening the range of the
uniform) does not quite seem to “recover” the distribution of log(1/X).
It seems we needed more Z values that are smaller to fill in the part of
the density near 0.</p>
<p>There’s another way to get Z to be “1/3 on average”. That is, we
could draw two uniforms, V ~ uniform(0,1) and W ~ uniform(0,1) and let
Z=min(V,W) (This insight was shown by Dr. Mihai Nica’s <a href="https://www.youtube.com/watch?v=Zx5T_IrNhUE" class="external-link">follow-up video</a>.
). Note, this is the same as letting Z ~ beta(1,<strong>3</strong>-1).
The <strong>3</strong> is bolded, because this is the number of
exponentials that are being summed. This gives us a way to generalize to
<strong>K</strong> exponentials being summed.</p>
<p><img src="xy_to_the_z_part_i_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<ul>
<li>nailed it!</li>
</ul>
<p>Let’s try it for summing 10 exponentials.</p>
<p>This means we need Z to be “1/10 on average”. That is, we could draw
9 uniforms let Z be the minimum of those 9 uniforms. This is the same as
letting Z ~ beta(1,<strong>10</strong>-1). The <strong>10</strong> is
bolded, because this is the number of exponentials we’re summing, and it
generalizes to any positive integer.</p>
<p>Be mindful of the x-axis and y-axis limits – they are not the same
for every plot!</p>
<p><img src="xy_to_the_z_part_i_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<!-- This is where turning to theory might save us some time. -->
<!-- <!-- Green note book page 88 and 89 -->
<p>–&gt;</p>
<!--   * The sum of 3 iid Exponential($\alpha$) variables will be distributed as Gamma(3,$\alpha$). -->
<!--   * If W ~ Gamma(3,lambda) then cW ~ Gamma(3, lambda/c) -->
<!--   * I'll leave it as an exercise for the reader, but the two best hopes for a choice of distribution for Z in trying to get the computed quantity back to the original Exponential is Z ~ U(0,1) or Z ~ Beta(2,1).  Either case ends up with Z(log(1/X)+log(1/Y)+log(1/A)) having a density that looks like an exponential density multiplied by extra stuff: -->
<!--     * $\lambda e^{-\lambda x} \times \left[ \frac{1+ \lambda x}{2} \right]$ or -->
<!--     * $\lambda e^{-\lambda x} \times \left[ \lambda x \right]$ -->
<!-- For kicks, I googled this problem of transforming Gamma(3,a) into Gamma(1,a) and got this from the AI results: -->
<!--   * A Gamma distribution times a Gamma distribution will result in an exponential distribution if the shape parameter of both Gamma distributions is 1, and their rate parameters are the same. In other words, if X ~ Gamma(1, λ) and Y ~ Gamma(1, λ), then their product X*Y ~ Exponential(λ).  -->
<!--   * Therefore \(Gamma(3,\alpha )\) cannot be transformed into \(Exponential(\alpha )\). \(Gamma(1,\alpha )\) is equal to \(Exponential(\alpha )\). -->
<!-- One can tinker and see how close they can get but the theory says it will be inexact. -->
<!--   * go through green books examples of trying to isolate the 'x' and showing that it is going to show up either way for n=3 and then plot! -->
<!-- See page 90 of green notebook. 2025-05-22. -->
<!-- As an exercize, one can solve for the density if Z is InverseGamma(az,bz) and then try to select az,bz >0  that gives the closest match to an exponential density. -->
<!-- One can even try Z ~ InverseGamma(.9,.2) (below), but the computed quantity is never going to be an Exponential.  So I guess the sum of two exponentials involved in this result is special and doesn't generalize to 3, i.e., while (XY)^Z is Uniform, (XYA)^Z won't be. -->
<!-- But wait! Dr. Mihai Nica saves the day again. If Z is min of two uniforms, then the relation will hold for sum of three exponentials with a commmon rate! [https://www.youtube.com/watch?v=Zx5T_IrNhUE](follow-up vid) -->
<!--   * Z~min(V,W) where V,W iid U(0,1) -->
<!--   * wait... that just makes Z ~ beta(1,2) -->
<p><!-- * What about 5 exponentials? -->
<!-- * do I take the min of 4 uniforms? -->
<!-- * Z~min(m,n,o,p) where m,n,o,p iid U(0,1) -->
<!-- * wait... that just makes Z ~ beta(1,4) --></p>
<p><!-- * max(V,W)^B ... I can't get it to work. is it for the other computed quantity (xy)^Z?? remember the code below is for (1/x * 1/y)^z --></p>
<p>All of these simulations and results are for a common
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>.
We consider the case unequal
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
case in <a href="https://swihart.github.io/mvpd/articles/xy_to_the_z_part_ii.html">part
II of this topic</a>.</p>
<div class="section level4">
<h4 id="miscellany-notes-to-self-stubs-for-future-ideas">Miscellany / Notes to self / Stubs for future ideas<a class="anchor" aria-label="anchor" href="#miscellany-notes-to-self-stubs-for-future-ideas"></a>
</h4>
<ul>
<li><p><a href="https://math.stackexchange.com/a/3173387/180716" class="external-link">Proof
of -ln(X) being an Exponential</a></p></li>
<li><p><a href="https://math.stackexchange.com/a/4039033/180716" class="external-link">Is this
transformation of beta relevant for a=0, b=1?</a></p></li>
<li><p><a href="https://stats.stackexchange.com/a/461337/35034" class="external-link">Keep in
back pocket for generalizing Uniform…U(-1,1)</a></p></li>
<li><p>Looking at the <a href="https://math.stackexchange.com/a/3485159/180716" class="external-link">inductive
form</a>, may provide insight as to why Z may not have a “recovering”
distribution for a sum of more than 2 exponentials.</p></li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bruce Swihart.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
